## Author: Zo√Øs Moitier

## usage: [C, D] = _fct_CD_tp(nu, w, zeta, k_max)
##
## Get the value for the function C_nu(zeta) and D_nu(zeta) when zeta is close to 0
## using Taylor expansion as in Table 2 in [Temme:1997]. The computation of the
## coefficients are done in the notebook `symbolic/comp_taylor_tp.ipynb`.
##

function [C, D] = _fct_CD_tp(nu, zeta, k_max)
  C_poly = {
    [
       6.659115127777360720e-7
       4.107853059125625140e-7
      -4.086341891153985910e-6
      -1.401236401529531600e-5
      -4.868525097863310910e-6
       9.621878534998689870e-5
       2.775244649530363820e-4
      -8.674301599339651640e-5
      -2.356591922460149520e-3
      -3.301587301587301590e-3
       2.519842099789746330e-2
       1.587401051968199470e-1
    ],
    [
       1.490769538126161160e-5
       1.247650380520302350e-5
      -4.618196013814738910e-5
      -1.503766113067485620e-4
      -9.394823234121864670e-5
       3.813580984866685550e-4
       7.803783518069232360e-4
      -3.443420589467373410e-4
      -2.169219042155678070e-3
    ],
    [
       1.590939650121653930e-4
       9.344755450005685270e-5
      -2.300065434590403190e-4
      -3.915976845459695130e-4
       7.600229291631408920e-5
       4.787844434277006440e-4
    ],
    [
       4.120253916287603680e-4
      -4.827575510382660030e-5
      -3.041182002744049600e-4
    ]
  };

  D_poly = {
    [1],
    [
      -3.290430179674090320e-6
       1.507361077042677800e-5
       5.698933397759949750e-5
       4.236994864059899100e-5
      -2.390073863580358520e-4
      -7.615129138938662750e-4
      -2.837944044772163440e-4
       3.328273778513411020e-3
       7.301587301587301590e-3
    ],
    [
      -4.403287818804338990e-5
       1.389611312787593470e-4
       3.796362004700549160e-4
       1.849209456941023410e-4
      -6.275714575779763350e-4
      -9.372994553946934900e-4
    ],
    [
      -1.818327746970648900e-4
       3.746773899373173770e-4
       4.444950415991404710e-4
    ]
  };

  inv_nu2 = power(nu, -2);
  C = polyval(C_poly{k_max+1}, zeta);
  D = polyval(D_poly{k_max+1}, zeta);
  for k = k_max:(-1):1
    C = polyval(C_poly{k}, zeta) .+ inv_nu2 .* C;
    D = polyval(D_poly{k}, zeta) .+ inv_nu2 .* D;
  end
end
